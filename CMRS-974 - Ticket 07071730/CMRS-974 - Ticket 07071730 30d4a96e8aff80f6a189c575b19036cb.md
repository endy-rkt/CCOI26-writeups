# CMRS-974 - Ticket 07071730

**About:**

- Category: Forensic
- Level: Hard

**Subject:**

Le Centre Météorologique Régional Spécialisé de la Reunion a détecté un trafic sortant anormal sur une station de monitoring pendant le passage du cyclone. Le DLP n'a déclenché aucune alerte. Un analyste a récupéré deux fichiers sur le poste compromis.

**Resource:**

- https://github.com/hiro974/CTF-Ticket-07071730/releases/download/0.1/ticket-070730.zip

In this challenge we are given a pcap and ssl log key

![image.png](CMRS-974%20-%20Ticket%2007071730/image.png)

so what is there in the pcap

![image.png](CMRS-974%20-%20Ticket%2007071730/image%201.png)

1. basically there are these conversation in the pcap

![image.png](CMRS-974%20-%20Ticket%2007071730/image%202.png)

1. as for the protocol there, we can see

![image.png](CMRS-974%20-%20Ticket%2007071730/image%203.png)

And there, there is TLS protocols so we need to decrypt these using the sslkeylog.txt given

 

![image.png](CMRS-974%20-%20Ticket%2007071730/image%204.png)

and after the we add the tls key, we have a new plain protocol in the protocol hierarchy , a HTTP one

![image.png](CMRS-974%20-%20Ticket%2007071730/image%205.png)

and then we see this plain text communication 

![image.png](CMRS-974%20-%20Ticket%2007071730/image%206.png)

we can also search for data in the export data

![image.png](CMRS-974%20-%20Ticket%2007071730/image%207.png)

and we see these

![image.png](CMRS-974%20-%20Ticket%2007071730/image%208.png)

we have these after download

![image.png](CMRS-974%20-%20Ticket%2007071730/image%209.png)

our first attempt is to see the flag but failed

![image.png](CMRS-974%20-%20Ticket%2007071730/image%2010.png)

so let’s try to see what are in these

![image.png](CMRS-974%20-%20Ticket%2007071730/image%2011.png)

we see the data that we have seen when we follow the http then we can check what is the content of these 

![image.png](CMRS-974%20-%20Ticket%2007071730/image%2012.png)

And from this we can see that there is some interesting dictionary here so 

so from this we can see that the description in the json data with the "name": "Mon tresor a qui saura le prendre” give the dictionary used to decrypt the description with the "name": "inpayloadwetrust***”

![image.png](CMRS-974%20-%20Ticket%2007071730/image%2013.png)

and then so for it let’s just craft a basic script  **decrypt.py** for it and eureka

![image.png](CMRS-974%20-%20Ticket%2007071730/image%2014.png)